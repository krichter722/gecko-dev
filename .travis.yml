# we can trigger the new travis infrastructure with `sudo: false` because working around `apt-get` commands is too much effort<ref>http://docs.travis-ci.com/user/migrating-from-legacy/</ref>
sudo: required
language: c
compiler:
 - gcc
 - clang
before_install:
 - sudo apt-get -qq update
 - sudo apt-get -qq install python-software-properties
 - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
 - sudo apt-get -qq update
 - sudo apt-get -qq install gcc-4.7 g++-4.7
 - sudo apt-get -qq build-dep firefox
# `mach build` fails even if `--jobs 1` is specfied because `cc1plus` instances get killed by OS (probably due to lack of memory in travis) -> travis unsuitable
script: export CC=gcc-4.7 CXX=g++-4.7 && ./mach build --jobs 1 && ./mach test testing/ && sudo ./mach install
after_failure: cat test-suite.log
